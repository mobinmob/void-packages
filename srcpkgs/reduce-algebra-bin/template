# Template file for 'reduce-algebra-bin'
pkgname=reduce-algebra-bin
version=20200301
revision=1
archs="x86_64"
_svnrev=5286
_upstr_version=snapshot_2020-03-01
wrksrc="reduce"
create_wrksrc="yes"
makedepends="patchelf"
depends="gnuplot texlive-bin ImageMagick ncurses-libs"
short_desc="Portable general-purpose computer algebra system"
maintainer="mobinmob <mobinmob@disroot.org>"
license="BSD-2-Clause"
homepage="https://reduce-algebra.sourceforge.io/"
distfiles="${SOURCEFORGE_SITE}/reduce-algebra/${_upstr_version}/linux64/reduce-complete_${_svnrev}_amd64.tgz"
checksum=1d4ccb8105278e99b217d69f24d91d66fa3fb01eb9346899a181800f959b0b44
# Strip when used after patchelf messes some executables.
nostrip="yes"
# libncurses.so.6.1 is not in shlibs
allow_unknown_shlibs=yes



do_install() {
	# Patch elf headers
	patchelf --replace-needed libtinfo.so.5 libncurses.so.6.1 usr/lib/reduce/cslbuild/csl/reduce
	patchelf --replace-needed libtinfo.so.5 libncurses.so.6.1 usr/lib/reduce/cslbuild/csl/csl
	patchelf --replace-needed libtinfo.so.5 libncurses.so.6.1 usr/lib/reduce/pslbuild/psl/bpsl
	patchelf --replace-needed libtinfo.so.5 libncurses.so.6.1 usr/lib/reduce/cslbuild/csl/bootstrapreduce
	patchelf --replace-needed libtinfo.so.5 libncurses.so.6.1 usr/bin/rfcsl
	patchelf --replace-needed libtinfo.so.5 libncurses.so.6.1 usr/bin/rfpsl
	# Copy all files and folders
	vcopy *  .
	# Install license
	vlicense usr/share/reduce/packages/LICENSE
}
